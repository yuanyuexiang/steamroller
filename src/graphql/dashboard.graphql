query GetDashboardData($today: String) {
  # 查询各个表的记录数（超级管理员 - 无权限过滤）
  orders(limit: 1000) {
    id
  }
  boutiques(limit: 1000) {
    id
  }
  terminals(limit: 1000) {
    id
  }
  customers(limit: 1000) {
    id
  }
  views(limit: 1000) {
    id
  }
  visits(limit: 1000) {
    id
  }
  
  # 使用聚合查询获取总数（超级管理员 - 无权限过滤）
  orders_aggregated {
    countAll
  }
  boutiques_aggregated {
    countAll
  }
  terminals_aggregated {
    countAll
  }
  customers_aggregated {
    countAll
  }
  views_aggregated {
    countAll
  }
  visits_aggregated {
    countAll
  }
  
  # 今日数据统计（超级管理员 - 无权限过滤）
  today_orders: orders(filter: { 
    date_created: { _gte: $today }
  }) {
    id
    status
  }
  
  today_views: views(filter: { 
    date_created: { _gte: $today }
  }) {
    id
  }
  
  today_visits: visits(filter: { 
    date_created: { _gte: $today }
  }) {
    id
  }
  
  # 获取所有访问记录用于统计最热门店铺
  all_visits_for_ranking: visits(limit: 1000, sort: ["-date_created"]) {
    id
    boutique {
      id
      name
      address
    }
    date_created
  }
  
  # 获取所有浏览记录用于统计最热门商品
  all_views_for_ranking: views(limit: 1000, sort: ["-date_created"]) {
    id
    product {
      id
      name
      images
      price
      category_id {
        id
        name
      }
    }
    date_created
  }
}

query GetRecentOrders($limit: Int = 5) {
  orders(limit: $limit, sort: ["-date_created"]) {
    id
    customer {
      id
      nick_name
    }
    total_price
    status
    date_created
  }
}
